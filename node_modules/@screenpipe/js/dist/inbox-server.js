import a from'express';var l=new Map;async function u(n){let s=a();return s.use(a.json()),s.use((o,e,t)=>{if(e.header("Access-Control-Allow-Origin","*"),e.header("Access-Control-Allow-Methods","GET, POST, OPTIONS"),e.header("Access-Control-Allow-Headers","Content-Type"),o.method==="OPTIONS"){e.sendStatus(200);return}t();}),s.post("/action",(o,e)=>{let{action:t}=o.body,c=l.get(t);c?c().then(()=>{e.json({success:true}),l.delete(t);}).catch(r=>{console.error("action callback failed:",r),e.status(500).json({success:false,error:r.message});}):e.status(404).json({success:false,error:"action not found"});}),new Promise(o=>{s.listen(n,()=>{console.log(`action server listening on port ${n}`),o(s);});})}export{l as actionCallbacks,u as startInboxServer};//# sourceMappingURL=inbox-server.js.map
//# sourceMappingURL=inbox-server.js.map